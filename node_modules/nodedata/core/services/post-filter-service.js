"use strict";
const utils_1 = require("../metadata/utils");
const Utils = require("../utils");
const decorators_1 = require('../constants/decorators');
const winstonLog_1 = require('../../logging/winstonLog');
const Enumerable = require('linq');
var Q = require('q');
class PostFilterService {
    static postFilter(result, preAuthParam) {
        var services = utils_1.MetaUtils.getMetaDataForDecorators([decorators_1.Decorators.SERVICE]);
        var service = Enumerable.from(services).where(x => x.metadata[0].params.serviceName == preAuthParam.serviceName).select(x => x.metadata[0]).firstOrDefault();
        if (service) {
            var param = [];
            param.push(result);
            var ret = service.target[preAuthParam.methodName].apply(service.target, param);
            if (Utils.isPromise(ret)) {
                return ret.then(result => {
                    return result;
                }).catch((err) => {
                    winstonLog_1.winstonLog.logError('[PostFilterService: postFilter]: error ' + err);
                    throw err;
                });
            }
            else {
                return Q.when(ret);
            }
        }
        return Q.when(true);
    }
}
exports.PostFilterService = PostFilterService;

//# sourceMappingURL=post-filter-service.js.map
