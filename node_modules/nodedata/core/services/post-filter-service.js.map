{"version":3,"sources":["core/services/post-filter-service.ts"],"names":[],"mappings":";AAAA,wBAAwB,mBAAmB,CAAC,CAAA;AAC5C,MAAY,KAAK,WAAM,UAAU,CAAC,CAAA;AAElC,6BAAyB,yBAAyB,CAAC,CAAA;AACnD,6BAAyB,0BAA0B,CAAC,CAAA;AACpD,MAAY,UAAU,WAAM,MAAM,CAAC,CAAA;AACnC,IAAI,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;AAErB;IAEI,OAAO,UAAU,CAAC,MAAM,EAAE,YAA+B;QACrD,IAAI,QAAQ,GAAG,iBAAS,CAAC,wBAAwB,CAAC,CAAC,uBAAU,CAAC,OAAO,CAAC,CAAC,CAAC;QACxE,IAAI,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,WAAW,IAAI,YAAY,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc,EAAE,CAAC;QAC7J,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACV,IAAI,KAAK,GAAG,EAAE,CAAC;YACf,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACnB,IAAI,GAAG,GAAG,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;YAC/E,EAAE,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACvB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM;oBAClB,MAAM,CAAC,MAAM,CAAC;gBAClB,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG;oBACT,uBAAU,CAAC,QAAQ,CAAC,yCAAyC,GAAG,GAAG,CAAC,CAAC;oBACrE,MAAM,GAAG,CAAC;gBACd,CAAC,CAAC,CAAC;YACP,CAAC;YACD,IAAI,CAAC,CAAC;gBACF,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACvB,CAAC;QACL,CAAC;QACD,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACxB,CAAC;AACL,CAAC;AAvBY,yBAAiB,oBAuB7B,CAAA","file":"core/services/post-filter-service.js","sourcesContent":["import {MetaUtils} from \"../metadata/utils\";\nimport * as Utils from \"../utils\";\nimport {IPostfilterParams} from '../decorators/interfaces';\nimport {Decorators} from '../constants/decorators';\nimport {winstonLog} from '../../logging/winstonLog';\nimport * as Enumerable from 'linq';\nvar Q = require('q');\n\nexport class PostFilterService {\n\n    static postFilter(result, preAuthParam: IPostfilterParams): Q.Promise<any> {\n        var services = MetaUtils.getMetaDataForDecorators([Decorators.SERVICE]);\n        var service = Enumerable.from(services).where(x => x.metadata[0].params.serviceName == preAuthParam.serviceName).select(x => x.metadata[0]).firstOrDefault();\n        if (service) {\n            var param = [];\n            param.push(result);\n            var ret = service.target[preAuthParam.methodName].apply(service.target, param);\n            if (Utils.isPromise(ret)) {\n                return ret.then(result => {\n                    return result;\n                }).catch((err) => {\n                    winstonLog.logError('[PostFilterService: postFilter]: error ' + err);\n                    throw err;\n                });\n            }\n            else {\n                return Q.when(ret);\n            }\n        }\n        return Q.when(true);\n    }\n}"],"sourceRoot":"/source/"}